"""
æœŸæƒç­–ç•¥æ¨èå™¨ - ç±»ä¼¼RockFlowçš„å°ç‰›å°ç†Š
"""

from typing import List, Dict


class OptionsRecommender:
    """
    æœŸæƒç­–ç•¥æ¨èå™¨
    æ ¹æ®åˆ†æç»“æœæ¨èç®€åŒ–ç‰ˆæœŸæƒç­–ç•¥
    """
    
    def recommend_strategies(
        self, 
        ticker: str,
        rating: str,  # "Buy" / "Hold" / "Sell"
        volatility: str = "medium"  # "low" / "medium" / "high"
    ) -> List[Dict]:
        """
        æ¨èæœŸæƒç­–ç•¥
        
        Args:
            ticker: è‚¡ç¥¨ä»£ç 
            rating: è¯„çº§
            volatility: æ³¢åŠ¨ç‡æ°´å¹³
        
        Returns:
            æœŸæƒç­–ç•¥åˆ—è¡¨
        """
        
        if rating.upper() == "BUY":
            return self._get_bullish_strategies(ticker, volatility)
        elif rating.upper() == "SELL":
            return self._get_bearish_strategies(ticker, volatility)
        else:  # HOLD
            return self._get_neutral_strategies(ticker, volatility)
    
    def _get_bullish_strategies(self, ticker: str, volatility: str) -> List[Dict]:
        """çœ‹æ¶¨ç­–ç•¥"""
        
        strategies = [
            {
                "name": "ğŸ‚ çœ‹æ¶¨ä¹°å…¥ (Buy Call)",
                "complexity": "â­",
                "é€‚åˆåœºæ™¯": "å¼ºçƒˆçœ‹æ¶¨ï¼Œé¢„æœŸå¤§æ¶¨",
                "é£é™©": "æœ‰é™ï¼ˆä»…æƒåˆ©é‡‘ï¼‰",
                "æ”¶ç›Š": "ç†è®ºæ— é™",
                "æˆæœ¬": "ä¸­ç­‰",
                "è¯´æ˜": f"ä¹°å…¥ {ticker} çœ‹æ¶¨æœŸæƒï¼ˆè¡Œæƒä»·ç•¥é«˜äºç°ä»·ï¼‰ã€‚é€‚åˆçœ‹å¥½çŸ­æœŸå¤§æ¶¨çš„æŠ•èµ„è€…ã€‚",
                "ä¼˜ç‚¹": [
                    "é£é™©æœ‰é™ï¼ˆæœ€å¤šæŸå¤±æƒåˆ©é‡‘ï¼‰",
                    "æ”¶ç›Šæ½œåŠ›å¤§",
                    "èµ„é‡‘å ç”¨å°‘"
                ],
                "ç¼ºç‚¹": [
                    "æ—¶é—´ä»·å€¼è¡°å‡",
                    "å¦‚æœä¸æ¶¨å¯èƒ½å…¨æŸ"
                ],
                "æ¨èåº¦": "â­â­â­â­â­" if volatility == "high" else "â­â­â­â­"
            },
            {
                "name": "ğŸ‚ ç‰›å¸‚ä»·å·® (Bull Call Spread)",
                "complexity": "â­â­",
                "é€‚åˆåœºæ™¯": "æ¸©å’Œçœ‹æ¶¨ï¼Œæ§åˆ¶æˆæœ¬",
                "é£é™©": "æœ‰é™",
                "æ”¶ç›Š": "æœ‰é™ä½†æˆæœ¬ä½",
                "æˆæœ¬": "ä½",
                "è¯´æ˜": f"åŒæ—¶ä¹°å…¥ä½è¡Œæƒä»·Call + å–å‡ºé«˜è¡Œæƒä»·Callã€‚é™ä½æˆæœ¬ï¼Œé€‚åˆç¨³å¥æŠ•èµ„è€…ã€‚",
                "ä¼˜ç‚¹": [
                    "æˆæœ¬ä½ï¼ˆæ”¶åˆ°æƒåˆ©é‡‘ï¼‰",
                    "é£é™©æ˜ç¡®",
                    "é€‚åˆéœ‡è¡ä¸Šæ¶¨"
                ],
                "ç¼ºç‚¹": [
                    "æ”¶ç›Šæœ‰ä¸Šé™",
                    "æ“ä½œå¤æ‚åº¦é«˜"
                ],
                "æ¨èåº¦": "â­â­â­â­" if volatility == "low" else "â­â­â­"
            }
        ]
        
        # å¦‚æœæ³¢åŠ¨ç‡é«˜ï¼Œæ·»åŠ æ¿€è¿›ç­–ç•¥
        if volatility == "high":
            strategies.append({
                "name": "ğŸš€ æ æ†çœ‹æ¶¨ (Leveraged Call)",
                "complexity": "â­â­â­",
                "é€‚åˆåœºæ™¯": "æåº¦çœ‹æ¶¨ï¼ŒçŸ­æœŸçˆ†å‘",
                "é£é™©": "é«˜",
                "æ”¶ç›Š": "æé«˜",
                "æˆæœ¬": "ä¸­é«˜",
                "è¯´æ˜": "ä¹°å…¥è™šå€¼ï¼ˆOTMï¼‰çœ‹æ¶¨æœŸæƒï¼Œé«˜é£é™©é«˜æ”¶ç›Šã€‚",
                "ä¼˜ç‚¹": ["æ”¶ç›Šå€æ•°å¤§", "é€‚åˆæ³¢æ®µæ“ä½œ"],
                "ç¼ºç‚¹": ["é£é™©æé«˜", "å®¹æ˜“å½’é›¶"],
                "æ¨èåº¦": "â­â­â­",
                "âš ï¸ é£é™©æç¤º": "ä»…é€‚åˆé£é™©æ‰¿å—èƒ½åŠ›å¼ºçš„æŠ•èµ„è€…ï¼"
            })
        
        return strategies
    
    def _get_bearish_strategies(self, ticker: str, volatility: str) -> List[Dict]:
        """çœ‹è·Œç­–ç•¥"""
        
        strategies = [
            {
                "name": "ğŸ» çœ‹è·Œä¹°å…¥ (Buy Put)",
                "complexity": "â­",
                "é€‚åˆåœºæ™¯": "çœ‹è·Œæˆ–å¯¹å†²ä¿æŠ¤",
                "é£é™©": "æœ‰é™ï¼ˆä»…æƒåˆ©é‡‘ï¼‰",
                "æ”¶ç›Š": "é«˜",
                "æˆæœ¬": "ä¸­ç­‰",
                "è¯´æ˜": f"ä¹°å…¥ {ticker} çœ‹è·ŒæœŸæƒã€‚å¯ç”¨äºçœ‹ç©ºæˆ–å¯¹å†²å·²æœ‰å¤šå¤´ã€‚",
                "ä¼˜ç‚¹": [
                    "é£é™©æœ‰é™",
                    "å¯å¯¹å†²è‚¡ç¥¨ä¸‹è·Œ",
                    "æ— éœ€èåˆ¸"
                ],
                "ç¼ºç‚¹": [
                    "æ—¶é—´ä»·å€¼è¡°å‡",
                    "æˆæœ¬è¾ƒé«˜"
                ],
                "æ¨èåº¦": "â­â­â­â­"
            },
            {
                "name": "ğŸ» ç†Šå¸‚ä»·å·® (Bear Put Spread)",
                "complexity": "â­â­",
                "é€‚åˆåœºæ™¯": "æ¸©å’Œçœ‹è·Œï¼Œé™ä½æˆæœ¬",
                "é£é™©": "æœ‰é™",
                "æ”¶ç›Š": "æœ‰é™ä½†æˆæœ¬ä½",
                "æˆæœ¬": "ä½",
                "è¯´æ˜": "ä¹°å…¥é«˜è¡Œæƒä»·Put + å–å‡ºä½è¡Œæƒä»·Putï¼Œé™ä½æˆæœ¬ã€‚",
                "ä¼˜ç‚¹": [
                    "æˆæœ¬ä½",
                    "é£é™©å¯æ§"
                ],
                "ç¼ºç‚¹": [
                    "æ”¶ç›Šæœ‰é™",
                    "æ“ä½œå¤æ‚"
                ],
                "æ¨èåº¦": "â­â­â­"
            }
        ]
        
        return strategies
    
    def _get_neutral_strategies(self, ticker: str, volatility: str) -> List[Dict]:
        """ä¸­æ€§ç­–ç•¥ï¼ˆæŒæœ‰æœŸæ”¶ç›Šå¢å¼ºï¼‰"""
        
        strategies = [
            {
                "name": "ğŸ’° å¤‡å…‘å¼€ä»“ (Covered Call)",
                "complexity": "â­â­",
                "é€‚åˆåœºæ™¯": "æŒæœ‰è‚¡ç¥¨ï¼Œèµšå–é¢å¤–æ”¶ç›Š",
                "é£é™©": "ä½ï¼ˆå·²æŒæœ‰è‚¡ç¥¨ï¼‰",
                "æ”¶ç›Š": "æƒåˆ©é‡‘æ”¶å…¥",
                "æˆæœ¬": "æ— ï¼ˆå·²æœ‰è‚¡ç¥¨ï¼‰",
                "è¯´æ˜": f"å¦‚æœä½ å·²æŒæœ‰ {ticker} è‚¡ç¥¨ï¼Œå¯ä»¥å–å‡ºçœ‹æ¶¨æœŸæƒèµšå–æƒåˆ©é‡‘ã€‚",
                "ä¼˜ç‚¹": [
                    "ç¨³å®šæ”¶å…¥",
                    "é™ä½æŒä»“æˆæœ¬",
                    "é€‚åˆé•¿æœŸæŒæœ‰"
                ],
                "ç¼ºç‚¹": [
                    "é™åˆ¶ä¸Šæ¶¨æ”¶ç›Š",
                    "éœ€è¦æŒæœ‰è‚¡ç¥¨"
                ],
                "æ¨èåº¦": "â­â­â­â­â­",
                "ğŸ’¡ æç¤º": "æœ€é€‚åˆé•¿æœŸæŠ•èµ„è€…å¢å¼ºæ”¶ç›Šï¼"
            },
            {
                "name": "ğŸ¯ é“é¹°å¼ (Iron Condor)",
                "complexity": "â­â­â­â­",
                "é€‚åˆåœºæ™¯": "é¢„æœŸæ¨ªç›˜ï¼Œæ³¢åŠ¨ç‡ä½",
                "é£é™©": "æœ‰é™",
                "æ”¶ç›Š": "æœ‰é™ï¼ˆæƒåˆ©é‡‘ï¼‰",
                "æˆæœ¬": "ä½",
                "è¯´æ˜": "å¤æ‚ç­–ç•¥ï¼Œé€‚åˆæ³¢åŠ¨ç‡ä½æ—¶èµšå–æ—¶é—´ä»·å€¼ã€‚",
                "ä¼˜ç‚¹": [
                    "æ¨ªç›˜ä¹Ÿèµšé’±",
                    "é£é™©å¯æ§"
                ],
                "ç¼ºç‚¹": [
                    "æ“ä½œå¤æ‚",
                    "éœ€è¦ç»éªŒ"
                ],
                "æ¨èåº¦": "â­â­",
                "âš ï¸ æé†’": "å»ºè®®å…ˆæŒæ¡åŸºç¡€ç­–ç•¥å†å°è¯•"
            }
        ]
        
        return strategies


# æµ‹è¯•ä»£ç ï¼ˆå¯é€‰ï¼‰
if __name__ == "__main__":
    recommender = OptionsRecommender()
    
    print("=" * 50)
    print("æµ‹è¯•ï¼šçœ‹æ¶¨ç­–ç•¥")
    print("=" * 50)
    
    strategies = recommender.recommend_strategies(
        ticker="AAPL",
        rating="Buy",
        volatility="medium"
    )
    
    for i, strategy in enumerate(strategies, 1):
        print(f"\nç­–ç•¥ {i}: {strategy['name']}")
        print(f"  å¤æ‚åº¦: {strategy['complexity']}")
        print(f"  æ¨èåº¦: {strategy['æ¨èåº¦']}")
